from wbtrl.Forum.models import *
from django.forms import ModelForm
from django.forms.models import modelformset_factory
from django.shortcuts import render_to_response
from wbtrl import models

ReplyFormset = formset_factory(ReplyForm, extra=2)
formset = ReplyFormSet(initial= ['...................']

class ReplyForm(ModelForm):
    class Meta:
        model = Reply
        field = '__all__'
        localized_fields = ('__all__',)

 def add_Reply



class QuestionForm(forms.ModelForm):
    class Meta:
        model = Question

        def add_Question(request):
            if request.method == "POST":
        pform = QuestionForm(request.POST, instance=Question())
        cforms = [ChoiceForm(request.POST, prefix=str(x), instance=Choice()) for x in range(0,3)]
        if pform.is_valid() and all([cf.is_valid() for cf in cforms]):
            new_Question = pform.save()
            for cf in cforms:
                new_choice = cf.save(commit=False)
                new_choice.Question = new_Question
                new_choice.save()
            return HttpResponseRedirect('/Question/add/')
    else:
        pform = PollForm(instance=Poll())
        cforms = [ChoiceForm(prefix=str(x), instance=Choice()) for x in range(0,3)]
    return render_to_response('add_poll.html', {'poll_form': pform, 'choice_forms': cforms})






class ChoiceForm(forms.ModelForm):
    class Meta:
        model = Choice
        exclude = ('question',)







  # def manage_reply(request):
   #     ReplyFormSet = modelformset_factory(Reply, fields=("question","patient","reply_text")
   #    if request.method == 'POST':
   #         formset = ReplyFormSet(request.POST, request.FILES)
   #         formset = ReplyFormSet(queryset=Question.objects.all())
   #         if formset.is_valid():
   #             formset.save()
   #     else:
   #             formset = ReplyFormSet(request.POST) 
   #     return render_to_response("formulaire.html", {    
   #     "formset": formset,
   #})   






